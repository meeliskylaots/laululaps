<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tartumaa laululaps 2026 - Elva valla eelvoor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF teek PDF-i tegemiseks -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Outfit:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4f46e5;
            --secondary: #7c3aed;
        }
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            scroll-behavior: smooth;
        }
        h1, h2, .font-outfit {
            font-family: 'Outfit', sans-serif;
        }
        .hero-gradient {
            background: radial-gradient(circle at top right, #6366f1, #4f46e5, #3730a3);
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 selection:bg-indigo-100 selection:text-indigo-900">

    <!-- Hero Sektsioon -->
    <header class="relative pt-24 pb-32 overflow-hidden">
        <div class="absolute inset-0 hero-gradient -skew-y-3 origin-top-left -z-10 h-[115%] shadow-2xl"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-white relative">
            <div class="mb-10 inline-flex items-center gap-2 bg-white/10 backdrop-blur-md px-6 py-2 rounded-full text-sm font-bold tracking-widest uppercase border border-white/20">
                <span class="w-2 h-2 bg-pink-400 rounded-full animate-ping"></span>
                Elva valla piirkondlik eelvoor
            </div>
            
            <h1 class="text-5xl md:text-7xl font-extrabold mb-8 leading-tight tracking-tight text-white">
                Hea noor solist!<br>
                <span class="text-indigo-200">Ära hoia oma laulurõõmu tagasi</span>
            </h1>

            <div class="max-w-2xl mx-auto bg-white/10 backdrop-blur-xl p-8 rounded-[2.5rem] border border-white/20 shadow-2xl mb-12">
                <p class="text-xl md:text-2xl mb-4 font-semibold text-white font-outfit">Tule "Tartumaa laululaps 2026" eelvoorule!</p>
                <div class="flex flex-col md:flex-row items-center justify-center gap-6 text-indigo-100 font-medium">
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-pink-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                        <span>29. märts 2026</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-pink-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <span>Kell 12:00</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-pink-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                        <span>Konguta rahvamajas</span>
                    </div>
                </div>
            </div>
            
            <div class="flex flex-col sm:flex-row gap-5 justify-center">
                <a href="#registreeri" class="bg-white text-indigo-700 px-12 py-5 rounded-2xl font-bold text-xl hover:bg-indigo-50 transition-all hover:scale-105 shadow-2xl shadow-indigo-900/20">Registreeri siin</a>
                <a href="https://docs.google.com/document/d/1hqLIVqfflw4a2zxmkZK0W4shnYkbegzB/edit?usp=drive_link&ouid=108559426715110697158&rtpof=true&sd=true" target="_blank" class="bg-indigo-600/40 text-white border border-white/30 px-10 py-5 rounded-2xl font-bold text-lg hover:bg-indigo-600/60 transition shadow-xl flex items-center gap-2 justify-center backdrop-blur-sm">
                    Loe üldjuhendit
                </a>
            </div>
        </div>
    </header>

    <!-- Peamine Sisu -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-16 relative z-10">
        
        <!-- Info paneelid -->
        <section class="grid md:grid-cols-3 gap-8 mb-24">
            <div class="glass-card p-10 rounded-[2.5rem] shadow-xl border-t-4 border-t-indigo-500 hover:transform hover:-translate-y-2 transition-all">
                <h3 class="text-xl font-bold mb-4 text-indigo-600 uppercase tracking-tight">Ajakava ja järjekord</h3>
                <p class="text-slate-600 leading-relaxed text-sm">
                    Ajakava avalikustatakse hiljemalt <strong>25.03.2026</strong> Konguta Rahvamaja Facebookis ja <a href="https://www.elvakultuur.ee" class="text-indigo-600 hover:underline">elvakultuur.ee</a> lehel.
                </p>
            </div>
            <div class="glass-card p-10 rounded-[2.5rem] shadow-xl border-t-4 border-t-purple-500 hover:transform hover:-translate-y-2 transition-all">
                <h3 class="text-xl font-bold mb-4 text-purple-600 uppercase tracking-tight">Registreerimine</h3>
                <p class="text-slate-600 leading-relaxed text-sm">
                    Ankeedi täitmine on avatud kuni <strong>20. märtsini</strong>. Vanust arvestatakse seisuga <strong>31.12.2026</strong>. Kõik väljad on kohustuslikud.
                </p>
            </div>
            <div class="glass-card p-10 rounded-[2.5rem] shadow-xl border-t-4 border-t-pink-500 hover:transform hover:-translate-y-2 transition-all">
                <h3 class="text-xl font-bold mb-4 text-pink-600 uppercase tracking-tight">Edasipääs</h3>
                <p class="text-slate-600 leading-relaxed text-sm">
                    Igast vanuserühmast pääseb kaks parimat Tartumaa laululaps 2026 maakondlikku lõppvooru, mis toimub mais 2026.
                </p>
            </div>
        </section>

        <!-- Ankeet -->
        <section id="registreeri" class="max-w-4xl mx-auto mb-32">
            <div class="bg-white p-8 md:p-16 rounded-[3.5rem] shadow-2xl shadow-indigo-200/50 border border-slate-100">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold mb-4 font-outfit">Registreerimisvorm</h2>
                    <p class="text-slate-500 text-lg mb-6">Täida ankeet ja pane oma talent proovile!</p>
                </div>
                
                <form id="googleSheetForm" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Osa 1: Isik -->
                    <div class="md:col-span-2">
                        <h3 class="text-lg font-bold text-indigo-600 flex items-center gap-2 mb-6">
                            <span class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-sm font-bold">1</span>
                            Andmed osaleja kohta
                        </h3>
                    </div>
                    
                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Laulja nimi *</label>
                        <input type="text" name="name" id="field_name" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>
                    
                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Sünniaeg (pp.kk.aaaa) *</label>
                        <input type="text" name="birthdate" id="field_birthdate" placeholder="01.01.2015" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Vanuserühm (seisuga 31.12.2026) *</label>
                        <select name="ageGroup" id="field_ageGroup" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                            <option value="">Vali...</option>
                            <option value="I rühm (3-7 a.)">I grupp: 3–7-aastased</option>
                            <option value="II rühm (8-10 a.)">II grupp: 8–10-aastased</option>
                            <option value="III rühm (11-13 a.)">III grupp: 11–13-aastased</option>
                            <option value="IV rühm (14-16 a.)">IV grupp: 14–16-aastased</option>
                        </select>
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Keda esindad (kool/stuudio) *</label>
                        <input type="text" name="school" id="field_school" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <!-- Osa 2: Laul -->
                    <div class="md:col-span-2 pt-6">
                        <h3 class="text-lg font-bold text-indigo-600 flex items-center gap-2 mb-6">
                            <span class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-sm font-bold">2</span>
                            Esituse andmed
                        </h3>
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Laulu pealkiri *</label>
                        <input type="text" name="song" id="field_song" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Laulu autorid *</label>
                        <input type="text" name="author" id="field_author" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Laulu täpne pikkus *</label>
                        <input type="text" name="duration" id="field_duration" placeholder="nt 2:50" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Taustalauljad (nimed ja arv) *</label>
                        <input type="text" name="backupSingers" id="field_backupSingers" placeholder="või 'Puuduvad'" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="md:col-span-2 space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Saade ja vajalik lisatehnika *</label>
                        <textarea name="accompaniment" id="field_accompaniment" rows="2" required placeholder="fono, klaver, mitu mikrofoni jne" class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white"></textarea>
                    </div>

                    <!-- Fonogrammi üleslaadimine -->
                    <div class="md:col-span-2 bg-indigo-50/50 p-8 rounded-[2rem] border-2 border-dashed border-indigo-200">
                        <label class="block text-sm font-extrabold text-indigo-900 mb-2">Fonogrammi üleslaadimine (vabatahtlik)</label>
                        <p class="text-xs text-indigo-600 mb-4 font-medium italic">Kui kasutad fonogrammi, võid selle siia üles laadida (MP3, max 10MB). Võid selle tuua ka mälupulgal kohapeale.</p>
                        <input type="file" id="audioFile" accept="audio/*" class="block w-full text-sm text-slate-500 file:mr-4 file:py-3 file:px-8 file:rounded-full file:border-0 file:text-sm file:font-bold file:bg-indigo-600 file:text-white hover:file:bg-indigo-700 transition-all cursor-pointer">
                    </div>

                    <!-- Osa 3: Juhendaja -->
                    <div class="md:col-span-2 pt-6">
                        <h3 class="text-lg font-bold text-indigo-600 flex items-center gap-2 mb-6">
                            <span class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-sm font-bold">3</span>
                            Juhendaja andmed
                        </h3>
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Juhendaja nimi *</label>
                        <input type="text" name="teacherName" id="field_teacherName" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="space-y-2">
                        <label class="text-sm font-bold text-slate-700 ml-1">Juhendaja kontakt (tel, e-post) *</label>
                        <input type="text" name="teacherContact" id="field_teacherContact" required class="w-full px-5 py-4 rounded-2xl border-2 border-slate-100 focus:border-indigo-500 outline-none transition-all bg-slate-50 focus:bg-white">
                    </div>

                    <div class="md:col-span-2 pt-8">
                        <button type="submit" id="submitBtn" class="w-full bg-indigo-600 text-white font-extrabold py-5 rounded-[1.5rem] hover:bg-indigo-700 transition-all shadow-xl shadow-indigo-200 hover:scale-[1.01] active:scale-[0.98] flex items-center justify-center gap-3 text-lg tracking-wide">
                            Kinnita registreerimine
                        </button>
                    </div>
                </form>

                <div id="successMsg" class="hidden text-center py-16 space-y-8">
                    <div class="w-24 h-24 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 scale-110">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                    </div>
                    <div>
                        <h3 class="text-3xl font-extrabold text-slate-900 mb-2">Registreeritud!</h3>
                        <p class="text-slate-600 text-lg max-w-md mx-auto leading-relaxed font-medium">Suur aitäh! Sinu andmed ja fail on edukalt edastatud Sinu Google Sheetsi ja Drive'i.</p>
                    </div>
                    
                    <div class="flex flex-col gap-4 justify-center pt-4 max-w-sm mx-auto">
                        <!-- PDF NUPP -->
                        <button id="downloadPdfBtn" class="bg-indigo-600 text-white px-8 py-4 rounded-2xl font-bold hover:bg-indigo-700 transition shadow-md flex items-center justify-center gap-3">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                            Laadi alla PDF kinnitus
                        </button>
                        
                        <div class="h-px bg-slate-100 my-2"></div>
                        
                        <!-- SAMA JUHENDAJA NUPP -->
                        <button id="regNextSameTeacher" class="bg-indigo-50 text-indigo-700 px-8 py-4 rounded-2xl font-bold hover:bg-indigo-100 transition border border-indigo-100 flex items-center justify-center gap-3">
                             <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" y1="8" x2="19" y2="14"/><line x1="22" y1="11" x2="16" y2="11"/></svg>
                             Sama juhendaja, uus õpilane
                        </button>
                        
                        <button onclick="location.reload()" class="bg-white text-slate-500 border border-slate-200 px-8 py-4 rounded-2xl font-bold hover:bg-slate-50 transition flex items-center justify-center gap-2">
                             Alusta täiesti uut registreerimist
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-slate-400 py-20 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-2 gap-16 text-center md:text-left">
            <div class="space-y-8">
                <div>
                    <p class="text-white font-black text-2xl uppercase tracking-wider mb-2 font-outfit">Tartumaa laululaps 2026</p>
                    <p class="text-indigo-400 font-bold uppercase text-xs tracking-[0.2em]">Elva valla eelvoor</p>
                </div>
                <div class="space-y-4">
                    <p class="text-indigo-200 font-bold text-sm tracking-widest uppercase">Eelvooru korraldaja:</p>
                    <div class="space-y-1">
                        <p class="text-white font-extrabold text-lg">Meelis Külaots</p>
                        <p class="text-sm">Konguta rahvamaja juhataja</p>
                    </div>
                    <div class="flex flex-col gap-3 pt-2 items-center md:items-start">
                        <a href="tel:5259576" class="hover:text-white transition flex items-center gap-2">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                            5259576
                        </a>
                        <a href="mailto:konguta.rahvamaja@elva.ee" class="hover:text-white transition flex items-center gap-2">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                            konguta.rahvamaja@elva.ee
                        </a>
                    </div>
                </div>
            </div>
            <div class="flex flex-col justify-between md:items-end">
                <div class="space-y-6 md:text-right">
                    <p class="text-indigo-200 font-bold text-sm tracking-widest uppercase mb-4">Lingid ja info:</p>
                    <div class="flex flex-col gap-3">
                        <a href="https://www.elvakultuur.ee" target="_blank" class="hover:text-white transition-colors font-medium">elvakultuur.ee</a>
                        <a href="https://www.facebook.com/kongutarahvamaja" target="_blank" class="hover:text-white transition-colors font-medium">Konguta Rahvamaja Facebook</a>
                        <a href="https://docs.google.com/document/d/1hqLIVqfflw4a2zxmkZK0W4shnYkbegzB/edit?usp=drive_link&ouid=108559426715110697158&rtpof=true&sd=true" target="_blank" class="text-indigo-400 hover:text-indigo-300 transition-colors font-bold">Võistluse üldjuhend</a>
                    </div>
                </div>
                <div class="pt-12 text-[10px] text-slate-600 uppercase tracking-[0.3em]">
                    © 2026 Elva Vald • Konguta Rahvamaja
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Sinu viimane kinnitatud Deployment URL:
        const scriptURL = 'https://script.google.com/macros/s/AKfycby7EHGNIxvGTsdtfWVD_jZjl3dJSn_21XbEijn_kNhsARW_TGW9NkNTFFzYfxQJTcUheQ/exec';

        const form = document.getElementById('googleSheetForm');
        const submitBtn = document.getElementById('submitBtn');
        const successMsg = document.getElementById('successMsg');
        const downloadPdfBtn = document.getElementById('downloadPdfBtn');
        const regNextSameTeacherBtn = document.getElementById('regNextSameTeacher');
        const audioInput = document.getElementById('audioFile');

        let lastSubmittedData = null;

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            submitBtn.disabled = true;
            submitBtn.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                Saadan andmeid...
            `;

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            lastSubmittedData = { ...data };

            // Faili töötlemine (Base64)
            if (audioInput.files.length > 0) {
                const file = audioInput.files[0];
                if (file.size > 10 * 1024 * 1024) {
                    alert("Fail on liiga suur (max 10MB). Palun saada fonogramm e-postiga.");
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'Kinnita registreerimine';
                    return;
                }
                const base64 = await toBase64(file);
                data.fileData = base64;
                data.fileName = `${data.name}_${data.song}_${file.name}`.replace(/[^a-z0-9.]/gi, '_');
            }

            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(() => {
                form.classList.add('hidden');
                successMsg.classList.remove('hidden');
                window.scrollTo({ top: document.getElementById('registreeri').offsetTop - 100, behavior: 'smooth' });
            })
            .catch(error => {
                console.error('Viga!', error.message);
                alert('Viga andmete saatmisel. Kontrolli ühendust või proovi uuesti.');
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Kinnita registreerimine';
            });
        });

        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        // "Sama juhendaja, uus õpilane" loogika
        regNextSameTeacherBtn.addEventListener('click', () => {
            // Tühjendame ainult õpilase ja laulu väljad, JÄTAME juhendaja ja asutuse alles
            const fieldsToClear = [
                'field_name', 'field_birthdate', 'field_ageGroup', 
                'field_song', 'field_author', 'field_duration', 
                'field_backupSingers', 'field_accompaniment'
            ];
            
            fieldsToClear.forEach(id => {
                document.getElementById(id).value = '';
            });
            
            audioInput.value = '';
            successMsg.classList.add('hidden');
            form.classList.remove('hidden');
            submitBtn.disabled = false;
            submitBtn.innerHTML = 'Kinnita registreerimine';
            window.scrollTo({ top: document.getElementById('registreeri').offsetTop - 100, behavior: 'smooth' });
        });

        // PDF Funktsionaalsus
        downloadPdfBtn.addEventListener('click', () => {
            if (!lastSubmittedData) return;

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const data = lastSubmittedData;

            // Päis
            doc.setFillColor(79, 70, 229);
            doc.rect(0, 0, 210, 40, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.text("REGISTREERIMISE KINNITUS", 105, 20, { align: "center" });
            doc.setFontSize(12);
            doc.text("Tartumaa laululaps 2026 - Elva valla eelvoor", 105, 30, { align: "center" });

            doc.setTextColor(40, 40, 40);
            doc.setFontSize(10);
            doc.text(`Kinnituse väljastamise aeg: ${new Date().toLocaleString('et-EE')}`, 20, 50);

            let y = 65;
            const drawRow = (label, value) => {
                doc.setFont("helvetica", "bold");
                doc.text(`${label}:`, 20, y);
                doc.setFont("helvetica", "normal");
                doc.text(String(value || '-'), 75, y);
                y += 10;
            };

            doc.setFontSize(14);
            doc.setFont("helvetica", "bold");
            doc.text("1. OSALEJA ANDMED", 20, y);
            y += 10;
            doc.setFontSize(11);
            drawRow("Laulja nimi", data.name);
            drawRow("Sünniaeg", data.birthdate);
            drawRow("Vanuserühm", data.ageGroup);
            drawRow("Asutus", data.school);

            y += 10;
            doc.setFontSize(14);
            doc.setFont("helvetica", "bold");
            doc.text("2. ESITUSE ANDMED", 20, y);
            y += 10;
            doc.setFontSize(11);
            drawRow("Laulu pealkiri", data.song);
            drawRow("Autorid", data.author);
            drawRow("Pikkus", data.duration);
            drawRow("Taustalauljad", data.backupSingers);
            drawRow("Saade/Tehnika", data.accompaniment);

            y += 10;
            doc.setFontSize(14);
            doc.setFont("helvetica", "bold");
            doc.text("3. JUHENDAJA ANDMED", 20, y);
            y += 10;
            doc.setFontSize(11);
            drawRow("Juhendaja nimi", data.teacherName);
            drawRow("Kontakt", data.teacherContact);

            y += 20;
            doc.setFontSize(10);
            doc.setTextColor(100, 100, 100);
            doc.text("Kohtume 29. märtsil Konguta rahvamajas!", 105, y, { align: "center" });

            doc.save(`Registreerimine_${data.name.replace(/\s+/g, '_')}.pdf`);
        });
    </script>
</body>
</html>
